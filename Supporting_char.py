import os
import csv

seznam = [{'Ime letališča': 'Dubai International Airport', 'Država': 'United Arab Emirates', 'Tip letališča': 'Major airport', 'Število prihodov': 621, 'Destinacije': ['Abha', 'Accra', 'Addis Ababa', 'Adler/Sochi', 'Ahmedabad', 'Al Najaf', 'Alexandria', 'Algiers', 'Almaty', 'Amman', 'Amritsar', 'Amsterdam', 'Angeles/Mabalacat', 'Antalya', 'Asmara', 'Astana', 'Athens', 'Auckland', 'Baghdad', 'Bahrain', 'Baku', 'Bandar Abbas', 'Bangkok', 'Barcelona', 'Basel/Mulhouse', 'Basrah', 'Beijing', 'Beirut', 'Belgrade', 'Bengaluru', 'Bhubaneshwar', 'Birmingham', 'Bishkek', 'Bologna', 'Boston', 'Brisbane', 'Brussels', 'Bucharest', 'Budapest', 'Cairo', 'Cape Town', 'Casablanca', 'Catania', 'Chah Bahar', 'Chandigarh', 'Chengdu', 'Chennai', 'Chicago', 'Chittagong', 'Cologne/Bonn', 'Colombo', 'Copenhagen', 'Dakar', 'Damascus', 'Dammam', 'Dar es Salaam', 'Delhi', 'Denpasar-Bali', 'Dhaka', 'Doha', 'Dublin', 'Duesseldorf', 'Durban', 'Dushanbe', 'Entebbe', 'Erbil', 'Faisalabad', 'Fort Worth', 'Frankfurt', 'Gassim', 'Geneva', 'Gheshm Island', 'Giza', 'Glasgow', 'Goa', 'Guangzhou', 'Hamburg', 'Hanoi', 'Hargeisa', 'Ho Chi Minh City', 'Hong Kong', 'Houston', 'Hyderabad', 'Isfahan', 'Islamabad', 'Istanbul', 'Jaipur', 'Jakarta', 'Jeddah', 'Johannesburg', 'Juba', 'Kabul', 'Kannur', 'Karachi', 'Kathmandu', 'Kazan', 'Kigali', 'Kish Island', 'Kochi', 'Kolkata', 'Kozhikode', 'Krakow/Balice', 'Kuala Lumpur', 'Kunming', 'Kuwait', 'Lagos', 'Lahore', 'Lar', 'Larnaca', 'Leipzig/Halle', 'Lisbon', 'Ljubljana', 'London', 'Los Angeles', 'Louisville', 'Lucknow', 'Lusaka', 'Lyon', 'Madinah', 'Madrid', 'Madurai', 'Mahe Island', 'Male', 'Manchester', 'Mangalore', 'Manila', 'Mashhad', 'Mauritius', 'Melbourne', 'Miami', 'Milan', 'Mineralnye Vody', 'Minsk', 'Mombasa', 'Montreal', 'Moscow', 'Multan', 'Mumbai', 'Munich', 'Muscat', 'Nairobi', 'Naples', 'Nejran', 'New York', 'Newcastle', 'Nice', 'Novosibirsk', 'Orlando', 'Osaka', 'Oslo', 'Paris', 'Penang', 'Perth', 'Peshawar', 'Phuket', 'Port Sudan', 'Poznan', 'Prague', 'Pune', 'Riga', 'Riyadh', 'Rome', 'Saint Petersburg', 'Salalah', 'Samara', 'Samarkand', 'San Francisco', 'Sao Paulo', 'Sarajevo', 'Seattle', 'Seoul', 'Shanghai', 'Shenzhen', 'Shiraz', 'Shymkent', 'Sialkot', 'Singapore', 'Sofia', 'Southampton', 'Stockholm', 'Sulaymaniyah', 'Surat', 'Sydney', 'Sylhet', 'Tabuk', 'Taif', 'Taipei', 'Tashkent', 'Tbilisi', 'Tehran', 'Tel Aviv-Yafo', 'Thiruvananthapuram', 'Tirana', 'Tiruchirappalli', 'Tokyo', 'Toronto', 'Tripoli', 'Tunis', 'U-Tapao', 'Venice', 'Vienna', 'Warsaw', 'Washington', "Xi'an", 'Yekaterinburg', 'Yerevan', 'Zagreb', 'Zanzibar', 'Zurich'], 'Število destinacij': 209, 'Letalske družbe': ['AJet', 'AZAL Azerbaijan Airlines', 'Aegean Airlines', 'Aeroflot', 'Air Algerie', 'Air Astana', 'Air Canada', 'Air China', 'Air France', 'Air India', 'Air India Express', 'Air Tanzania', 'Airblue', 'Ariana Afghan Airlines', 'Badr Airlines', 'Batik Air', 'Belavia', 'Biman Bangladesh Airlines', 'British Airways', 'Cathay Pacific', 'Cebu Pacific Air', 'China Easter', 'China Southern Airlines', 'Corendon Air', 'Cyprus Airways', 'DHL Air', 'Egyptair', 'Emirates', 'Ethiopian Airlines', 'FitsAir', 'FlexFlight', 'Fly Baghdad', 'Fly Oya', 'Flyadeal', 'GP Aviation', 'Gulf Air', 'Hi Fly', 'Himalaya Airlines', 'IndiGo', 'Iran Airtour', 'Iraqi Airways', 'Jazeera Airways', 'KLM', 'KOREAN AIR LINES CO, LTD.', 'Kam Air', 'Kenya Airways', 'Kuwait Airways', 'Lufthansa', 'Mahan Air', 'Malindo Air', 'Middle East Airlines', 'My Freighter', 'Nepal Airlines', 'Oman Air', 'Pakistan International Airlines', 'Pegasus Airlines', 'Philippine Airlines', 'Qatar Airways', 'Qeshm Airlines', 'Royal Brunei Airlines', 'Royal Jordanian', 'RwandAir', 'SalamAir', 'Saudia', 'Sichuan Airlines', 'Singapore Airlines', 'Sky Angkor', 'Smart Lynx Airlines', 'SpiceJet', 'SriLankan Airlines', 'Starlink Aviation', 'SunExpress', 'Swiss', 'Syrian Air', 'Tarco Aviation', 'Turkish Airlines', 'UPS Airlines', 'US-Bangla Airlines', 'Uganda Airlines', 'United Airlines', 'Uzbekistan Airways', 'VistaJet', 'Vistara', 'Wizz Air', 'airBaltic', 'flydubai', 'flynas'], 'Število let. družb': 87, 'Povprečna zamuda letov': '20 minut'}, {'Ime letališča': 'Singapore Changi Airport', 'Država': 'Singapore', 'Tip letališča': 'Major airport', 'Število prihodov': 546, 'Destinacije': ['Abu Dhabi', 'Adelaide', 'Ahmedabad', 'Amritsar', 'Amsterdam', 'Angeles/Mabalacat', 'Athens', 'Auckland', 'Bahrain', 'Baku', 'Balikpapan', 'Bandar Seri Begawan', 'Bangkok', 'Barcelona', 'Beijing', 'Bengaluru', 'Brisbane', 'Broome', 'Busan', 'Cebu', 'Changsha', 'Chengdu', 'Chennai', 'Chiang Mai', 'Chongqing', 'Christchurch', 'Coimbatore', 'Colombo', 'Copenhagen', 'Da Nang', 'Darwin', 'Davao', 'Delhi', 'Denpasar-Bali', 'Dhaka', 'Dili', 'Doha', 'Dubai', 'Frankfurt', 'Fukuoka', 'Fuzhou', 'Guangzhou', 'Guwahati', 'Haikou', 'Hangzhou', 'Hanoi', 'Hat Yai', 'Helsinki', 'Ho Chi Minh City', 'Hong Kong', 'Honolulu', 'Hyderabad', 'Ipoh', 'Istanbul', 'Jakarta', 'Jeddah', 'Johannesburg', 'Kaohsiung', 'Kathmandu', 'Ko Samui', 'Kochi', 'Kolkata', 'Kota Kinabalu', 'Krabi', 'Kuala Lumpur', 'Kuching', 'Kunming', 'Langkawi', 'Leipzig/Halle', 'London', 'Los Angeles', 'Macau', 'Madurai', 'Majalengka', 'Male', 'Manado', 'Manila', 'Medan', 'Melbourne', 'Milan', 'Miri', 'Mumbai', 'Munich', 'Nadi', 'Nagoya', 'Nanchang', 'Nanjing', 'Nanning', 'New York', 'Osaka', 'Paris', 'Pekanbaru', 'Penang', 'Perth', 'Phnom Penh', 'Phuket', 'Port Moresby', 'Rome', 'San Francisco', 'Sanya', 'Seoul', 'Shanghai', 'Sharjah', 'Shenzhen', 'Surabaya', 'Sydney', 'Taipei', 'Thiruvananthapuram', 'Tianjin', 'Tiruchirappalli', 'Tokyo', 'Vancouver', 'Vientiane', 'Vishakhapatnam', 'Wuhan', 'Wuxi', 'Xiamen', 'Yangon', 'Yogyakarta', 'Zurich'], 'Število destinacij': 120, 'Letalske družbe': ['ASIANA AIRLINES INC.', 'Aero Dili', 'Air Canada', 'Air China', 'Air France', 'Air Hong Kong', 'Air India', 'Air India Express', 'Air Japan', 'Air Macau', 'Air New Zealand', 'Air Niugini', 'AirAsia', 'All Nippon Airways', 'Bangkok Airways', 'Batik Air', 'Biman Bangladesh Airlines', 'British Airways', 'Cambodia Airways', 'Cathay Pacific', 'Cebu Pacific Air', 'Central Airlines', 'China Airlines', 'China Cargo', 'China Easter', 'China Southern Airlines', 'Chongqing Airlines', 'Citilink', 'DHL Air', 'Drukair', 'EVA Air', 'Emirates', 'Ethiopian Airlines', 'Etihad Airways', 'Fiji Airways', 'Finnair', 'Firefly', 'Garuda Indonesia', 'Guangxi Beibu Gulf Airlines', 'Gulf Air', 'Hainan Airlines', 'Hong Kong Air Cargo', 'IndiGo', 'Indonesia AirAsia', 'JAL', 'Jeju Air', 'Jetstar', 'Jetstar Asia', 'Juneyao Airlines', 'K-Mile Air', 'KLM', 'KOREAN AIR LINES CO, LTD.', 'Longhao Airlines', 'Lufthansa', 'Malaysia Airlines', 'Malindo Air', 'Myanmar Airways International', 'Myanmar National Airlines', 'NCA - Nippon Cargo Airlines', 'Philippine Airlines', 'Qantas', 'Qatar Airways', 'Royal Brunei Airlines', 'SF Airlines', 'Saudia', 'Scoot', 'Shandong Airlines', 'Shanghai Airlines', 'Shenzhen Airlines', 'Sichuan Airlines', 'Silk Way West', 'Singapore Airlines', 'SriLankan Airlines', 'Starlux', 'Suparna Airlines', 'Swiss', "T'Way Air", 'Thai AirAsia', 'Thai Airways International', 'Thai Lion Air', 'Tianjin Air Cargo', 'TransNusa', 'Tri-MG Intra Asia Airlines', 'Turkish Airlines', 'UPS Airlines', 'US-Bangla Airlines', 'United Airlines', 'VietJet Air', 'Vietnam Airlines', 'Vistara', 'Xiamen Airlines', 'YTO Cargo Airlines', 'Zipair'], 'Število let. družb': 93, 'Povprečna zamuda letov': '15 minut'}, {'Ime letališča': 'Narita International Airport', 'Država': 'Singapore', 'Tip letališča': 'Major airport', 'Število prihodov': 417, 'Destinacije': ['Abu Dhabi', 'Amami', 'Amsterdam', 'Anchorage', 'Angeles/Mabalacat', 'Asahikawa', 'Auckland', 'Baku', 'Bangkok', 'Beijing', 'Belgrade', 'Boston', 'Brisbane', 'Busan', 'Cairns', 'Calgary', 'Cebu', 'Changchun', 'Changzhou', 'Chengdu', 'Cheongju', 'Chicago', 'Cincinnati', 'Colombo', 'Da Nang', 'Daegu', 'Dalian', 'Denpasar-Bali', 'Denver', 'Doha', 'Dubai', 'Fort Worth', 'Frankfurt', 'Fukuoka', 'Fuzhou', 'Guam', 'Guangzhou', 'Hangzhou', 'Hanoi', 'Harbin', 'Helsinki', 'Hiroshima', 'Ho Chi Minh City', 'Hong Kong', 'Honolulu', 'Houston', 'Ishigaki', 'Istanbul', 'Jakarta', 'Kagoshima', 'Kaohsiung', 'Kathmandu', 'Kitakyushu', 'Kochi', 'Kuala Lumpur', 'Kumamoto', 'Los Angeles', 'Louisville', 'Luxembourg', 'Macau', 'Manila', 'Matsuyama', 'Melbourne', 'Memphis', 'Mexico City', 'Milan', 'Miyakojima', 'Miyazaki', 'Monterrey', 'Montreal', 'Mumbai', 'Nadi', 'Nagasaki', 'Nagoya', 'Nanjing', 'Nantong', 'New York', 'Oakland', 'Oita', 'Okinawa', 'Osaka', 'Paris', 'Qingdao', 'San Diego', 'San Francisco', 'Sapporo', 'Seattle', 'Seoul', 'Shanghai', 'Shenyang', 'Shenzhen', 'Singapore', 'Taipei', 'Takamatsu', 'Tianjin', 'Toronto', 'Ulaanbaatar', 'Vancouver', 'Vienna', 'Warsaw', 'Weihai', 'Wenzhou', 'Wuhan', 'Wuxi', "Xi'an", 'Xiamen', 'Zhengzhou', 'Zurich'], 'Število destinacij': 108, 'Letalske družbe': ['ASIANA AIRLINES INC.', 'Aero K', 'Aeromexico', 'Air Busan', 'Air Canada', 'Air China', 'Air France', 'Air Hong Kong', 'Air Incheon', 'Air Japan', 'Air Macau', 'Air New Zealand', 'Air Premia', 'Air Seoul', 'Air Serbia', 'AirAsia', 'AirAsia X', 'All Nippon Airways', 'American Airlines', 'Atlas Air', 'Austrian Airlines', 'Batik Air', 'Cargojet', 'Cargolux', 'Cargolux Italia', 'Cathay Pacific', 'Cebu Pacific Air', 'China Airlines', 'China Cargo', 'China Easter', 'China Postal Airlines', 'China Southern Airlines', 'DHL Air', 'Donghai Airlines', 'EASTAR JET', 'EVA Air', 'Emirates', 'Ethiopian Airlines', 'Etihad Airways', 'FedEx', 'Fiji Airways', 'Finnair', 'Garuda Indonesia', 'Greater Bay Airlines', 'Hainan Airlines', 'Hong Kong Airlines', 'Hong Kong Express', 'JAL', 'Jeju Air', 'Jet Linx Aviation', 'Jetstar', 'Jetstar Japan', 'Jin Air', 'Juneyao Airlines', 'KLM', 'KOREAN AIR LINES CO, LTD.', 'Kalitta Air', 'LOT Polish Airlines', 'Loong Air', 'Lufthansa', 'Lufthansa Cargo', 'Malaysia Airlines', 'Malindo Air', 'Miat - Mongolian Airlines', 'NCA - Nippon Cargo Airlines', 'Nepal Airlines', 'Peach Aviation', 'Philippine Airlines', 'Polar Air Cargo', 'Qantas', 'Qatar Airways', 'SF Airlines', 'Scoot', 'Shenzhen Airlines', 'Sichuan Airlines', 'Silk Way West', 'Singapore Airlines', 'Spring Airlines', 'Spring Airlines Japan', 'SriLankan Airlines', 'Starlux', 'Swiss', "T'Way Air", 'Thai Airways International', 'Thai Lion Air', 'Tianjin Air Cargo', 'Tigerair Taiwan', 'Turkish Airlines', 'UPS Airlines', 'United Airlines', 'VietJet Air', 'Vietnam Airlines', 'Western Global Airlines', 'Westjet Airlines LTD', 'Xiamen Airlines', 'YTO Cargo Airlines', 'Zipair'], 'Število let. družb': 97, 'Povprečna zamuda letov': '19 minut'}, {'Ime letališča': 'Hong Kong International Airport', 'Država': 'Hong Kong', 'Tip letališča': 'Closed airport', 'Število prihodov': 562, 'Destinacije': ['Abu Dhabi', 'Addis Ababa', 'Almaty', 'Amsterdam', 'Anchorage', 'Angeles/Mabalacat', 'Auckland', 'Baku', 'Bangkok', 'Beijing', 'Bengaluru', 'Brisbane', 'Brussels', 'Busan', 'Cairo', 'Cebu', 'Chengdu', 'Chiang Mai', 'Chicago', 'Chongqing', 'Colombo', 'Da Nang', 'Dalian', 'Dammam', 'Delhi', 'Denpasar-Bali', 'Doha', 'Dubai', 'Farnborough', 'Frankfurt', 'Fukuoka', 'Fuzhou', 'Guangzhou', 'Haikou', 'Hangzhou', 'Hanoi', 'Helsinki', 'Ho Chi Minh City', 'Honolulu', 'Istanbul', 'Jakarta', 'Jeddah', 'Jeju', 'Jinan', 'Johannesburg', 'Kaohsiung', 'Karaganda', 'Kathmandu', 'Ko Samui', 'Koror', 'Kota Kinabalu', 'Kuala Lumpur', 'Kuching', 'Kumamoto', 'Kunming', 'Kuwait', 'Labuan', 'Lanzhou', 'Leipzig/Halle', 'Liege', 'London', 'Los Angeles', 'Luxembourg', 'Madrid', 'Manchester', 'Manila', 'Melbourne', 'Milan', 'Mumbai', 'Muscat', 'Nadi', 'Nagoya', 'Nanchang', 'Nanjing', 'Nantong', 'New York', 'Ningbo', 'Nottingham', 'Okinawa', 'Osaka', 'Paris', 'Penang', 'Perth', 'Phnom Penh', 'Phu Quoc Island', 'Phuket', 'Qingdao', 'Quanzhou', 'Riyadh', 'San Francisco', 'Sanya', 'Sapporo', 'Seoul', 'Shanghai', 'Singapore', 'Surabaya', 'Sydney', 'Taichung', 'Taipei', 'Tehran', 'Tel Aviv-Yafo', 'Tianjin', 'Tokyo', 'Toronto', 'Ulaanbaatar', 'Vancouver', 'Vientiane', 'Wenzhou', 'Wuhan', 'Wuxi', "Xi'an", 'Xiamen', 'Xining', 'Yinchuan', 'Zhangjiajie', 'Zhengzhou', 'Zurich'], 'Število destinacij': 117, 'Letalske družbe': ['9 Air Co', 'ASIANA AIRLINES INC.', 'ASL Airlines Belgium', 'ASL Airlines Ireland', 'Aerotranscargo', 'Air Atlanta Icelandic', 'Air Canada', 'Air China', 'Air France', 'Air Hong Kong', 'Air India', 'Air New Zealand', 'AirACT', 'AirAsia', 'AlisCargo Airlines', 'All Nippon Airways', 'Atlas Air', 'Bangkok Airways', 'Batik Air', 'British Airways', 'C.A.L. Cargo Airlines', 'CMA CGM AirCargo', 'Cambodia Angkor Air', 'Cargolux', 'Cargolux Italia', 'Cathay Pacific', 'Cebu Pacific Air', 'China Airlines', 'China Easter', 'China Southern Airlines', 'Compass Cargo Airlines', 'DHL Air', 'EVA Air', 'EgyptAir Cargo', 'Egyptair', 'Emirates', 'Ethiopian Airlines', 'Etihad Airways', 'Fiji Airways', 'Finnair', 'Garuda Indonesia', 'Greater Bay Airlines', 'Hainan Airlines', 'Hong Kong Air Cargo', 'Hong Kong Airlines', 'Hong Kong Express', 'IndiGo', 'JAL', 'Jeju Air', 'Jin Air', 'Juneyao Airlines', 'K-Mile Air', 'KOREAN AIR LINES CO, LTD.', 'Kalitta Air', 'Loong Air', 'Lufthansa', 'Lufthansa Cargo', 'Malaysia Airlines', 'Malindo Air', 'Miat - Mongolian Airlines', 'NCA - Nippon Cargo Airlines', 'Nepal Airlines', 'One Air', 'Peach Aviation', 'Philippine Airlines', 'Polar Air Cargo', 'Qantas', 'Qatar Airways', 'Qatar Executive', 'Qingdao Airlines', 'Raya Airways', 'SF Airlines', 'Saudia', 'Scoot', 'Shandong Airlines', 'Shanghai Airlines', 'Shenzhen Airlines', 'Sichuan Airlines', 'Silk Way West', 'Singapore Airlines', 'Starlux', 'Suparna Airlines', 'Swiss', "T'Way Air", 'Thai Airways International', 'Thai Lion Air', 'Turkish Airlines', 'UPS Airlines', 'United Airlines', 'VietJet Air', 'Vietnam Airlines', 'Vistara', 'Xiamen Airlines', 'YTO Cargo Airlines'], 'Število let. družb': 94, 'Povprečna zamuda letov': '25 minut'}]

def st_letalisc_v_drzavi(seznam):
    nov_slovar = {}
    for slovar in seznam:
        drzava = slovar['Država']
        if drzava not in nov_slovar:
            nov_slovar[drzava] = {"Število letališč": 1, "Število prihodov": slovar['Število prihodov']}
        else:
            nov_slovar[drzava]["Število letališč"] += 1
            nov_slovar[drzava]["Število prihodov"] += slovar['Število prihodov']
    # Pretvori slovar nazaj v seznam slovarjev
    nov_seznam = [{"Država": drzava, **podatki} for drzava, podatki in nov_slovar.items()]  
    return nov_seznam


whatever = st_letalisc_v_drzavi(seznam)

def zapisi_dodatni_csv(whatever):
    print(whatever)
    os.makedirs("CSVing", exist_ok=True)
    dat_ime = os.path.join("CSVing", "Supporting.csv")
    with open(dat_ime, "w", encoding="utf-8", newline="") as csv_file:
        writer = csv.DictWriter(csv_file, fieldnames=whatever[0].keys())
        writer.writeheader()
        writer.writerows(whatever)


def st_zaprtih_letalisc(seznam):
    nov_slovar = {}
    for slovar in seznam:
        if slovar["Tip letališča"] == "Closed airport":
            if slovar['Država'] not in nov_slovar:
                nov_slovar[slovar['Država']] = 1
            else:
                nov_slovar[slovar['Država']] += 1
    return nov_slovar